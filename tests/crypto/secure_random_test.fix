module SecureRandomTest;

import Minilib.Crypto.SecureRandom;
import Minilib.Testing.UnitTest;

test_generate_bytes: TestCase;
test_generate_bytes = (
    make_table_test("test_generate_bytes",
        [
            0,
            1,
            512,
        ],
        |size|
        let secure_random = *SecureRandom::make;
        let (secure_random, bytes) = *secure_random.generate_bytes(size);
        assert_equal("size", size, bytes.get_size)
    )
);

main: IO ();
main = (
    [
        test_generate_bytes,
        TestCase::empty
    ]
    .run_test_driver
);
